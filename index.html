<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Production Plan (Multi-Restaurant) - Luxury Edition</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/lucide@latest"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrious/4.0.2/qrious.min.js"></script>
    <style>
        :root {
            --accent-color: #fbbf24; /* amber-400 */
            --accent-color-text-dark: #1f2937;
        }
        [data-theme="blue"] {
            --accent-color: #38bdf8; /* sky-400 */
        }
        [data-theme="green"] {
            --accent-color: #34d399; /* emerald-400 */
        }

        body {
            font-family: 'Kanit', sans-serif;
            background-color: #000000;
            color: #e5e7eb; 
        }
        .header-gradient {
            background: linear-gradient(145deg, #1f1f1f 0%, #000000 100%);
        }
        .restaurant-tab {
            transition: all 0.3s ease;
            border-bottom: 3px solid transparent;
        }
        .restaurant-tab.active {
            color: var(--accent-color);
            border-bottom-color: var(--accent-color);
            background-color: #111827;
        }
        .shoot-day-badge {
            background-color: var(--accent-color);
            color: var(--accent-color-text-dark);
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            position: relative;
            z-index: 10;
            cursor: pointer;
        }
        .shoot-day-badge::before {
            content: '';
            position: absolute;
            top: -2px; left: -2px; right: -2px; bottom: -2px;
            background-color: var(--accent-color);
            filter: blur(8px);
            border-radius: 0.25rem;
            opacity: 0.6;
            z-index: -1;
            transition: opacity 0.3s ease-in-out;
        }
        .shoot-day-badge:hover::before {
            opacity: 1;
            filter: blur(12px);
        }
        .shoot-day-badge-container {
            position: relative;
            display: inline-block;
        }
        .shoot-day-popover {
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%) translateY(-10px);
            background-color: #1a1a1a;
            border: 1px solid var(--accent-color);
            border-radius: 0.5rem;
            padding: 0.75rem 1rem;
            color: #e5e7eb;
            font-size: 0.875rem;
            white-space: nowrap;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s ease, visibility 0.3s ease, transform 0.3s ease;
            z-index: 50;
            box-shadow: 0 4px 15px rgba(0,0,0, 0.5);
            min-width: 200px;
        }
        .shoot-day-popover::after {
            content: '';
            position: absolute;
            top: 100%; left: 50%;
            transform: translateX(-50%) translateY(-1px);
            width: 0; height: 0;
            border-left: 8px solid transparent;
            border-right: 8px solid transparent;
            border-top: 8px solid var(--accent-color);
        }
        .shoot-day-popover ul { list-style: none; padding: 0; margin: 0; text-align: left; }
        .shoot-day-popover li {
            padding: 0.25rem 0;
            border-bottom: 1px dashed #374151;
            cursor: pointer;
            transition: color 0.2s ease-in-out;
        }
        .shoot-day-popover li:hover { color: var(--accent-color); }
        .shoot-day-popover li:last-child { border-bottom: none; }
        .shoot-day-badge-container:hover .shoot-day-popover,
        .shoot-day-popover.popover-visible {
            opacity: 1;
            visibility: visible;
            transform: translateX(-50%) translateY(-20px);
        }
        .modal { transition: opacity 0.3s ease, visibility 0.3s ease; }
        .modal-content {
            transition: transform 0.3s ease;
            box-shadow: 0px 0px 50px rgba(0,0,0, 0.5);
        }
        @keyframes fadeInUp { from { opacity: 0; transform: translateY(30px); } to { opacity: 1; transform: translateY(0); } }
        .fade-in-up { animation: fadeInUp 0.7s ease-out forwards; }
        
        /* New Calendar Styles */
        .calendar-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 2px;
        }
        .calendar-header {
            text-align: center;
            font-weight: 600;
            padding: 0.5rem 0.25rem;
            background-color: #111827;
            border-radius: 0.375rem;
            color: var(--accent-color);
            font-size: 0.75rem;
        }
        .calendar-day {
            background-color: #09090b;
            border: 1px solid #27272a;
            min-height: 100px;
            padding: 0.25rem;
            border-radius: 0.375rem;
            transition: border-color 0.3s ease;
            display: flex;
            flex-direction: column;
        }
        .calendar-day.other-month {
            background-color: #030712;
            opacity: 0.5;
        }
        .calendar-day:hover {
            border-color: var(--accent-color);
        }
        .day-number {
            font-weight: 700;
            font-size: 0.75rem;
            margin-bottom: 0.25rem;
        }
        .content-entry {
            background-color: #1f2937;
            padding: 0.2rem 0.4rem;
            border-radius: 0.25rem;
            font-size: 0.65rem; /* smaller font for mobile */
            cursor: pointer;
            transition: background-color 0.2s ease;
            white-space: normal; /* Allow text wrapping */
            word-break: break-word; /* Break long words */
            border-left: 3px solid var(--accent-color);
        }
        .content-entry:hover {
            background-color: #374151;
        }
    </style>
</head>
<body class="text-gray-200">

    <header class="header-gradient text-white p-6 sm:p-8 shadow-2xl text-center border-b-2" style="border-color: var(--accent-color);">
        <h1 class="text-3xl sm:text-4xl md:text-5xl font-bold tracking-wide">Production Plan</h1>
        <p id="restaurant-name-header" class="text-lg sm:text-xl mt-2 font-light" style="color: var(--accent-color);"></p>
    </header>

    <div class="bg-gray-900 border-b-2 border-gray-800 sticky top-0 z-40">
        <div id="restaurant-tabs" class="container mx-auto flex items-center sm:justify-center overflow-x-auto">
            <!-- Tabs will be injected here -->
        </div>
    </div>

    <div class="container mx-auto p-4 sm:px-6 md:px-8 mt-8">
        <section id="shooting-summary" class="fade-in-up" style="animation-delay: 150ms;">
            <h2 class="text-2xl sm:text-3xl font-bold mb-4 border-b-2 border-gray-800 pb-2 flex items-center space-x-3" style="color: var(--accent-color);">
                <i data-lucide="clapperboard" class="w-7 h-7 sm:w-8 sm:h-8"></i>
                <span>สรุปวันถ่ายทำ (Shooting Schedule)</span>
            </h2>
            <div id="schedule-container" class="space-y-4"></div>
        </section>
    </div>

    <main class="container mx-auto p-4 sm:p-6 md:p-8">
        <div id="calendar-container" class="overflow-x-auto"></div>
    </main>

    <div id="detail-modal" class="modal fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-80 p-4 opacity-0 invisible">
        <div id="modal-content" class="modal-content bg-black border-2 rounded-lg shadow-2xl w-full max-w-2xl max-h-[90vh] overflow-y-auto transform scale-95" style="border-color: var(--accent-color);">
            <div class="sticky top-0 bg-black bg-opacity-80 backdrop-blur-sm p-4 sm:p-5 border-b flex justify-between items-center" style="border-color: var(--accent-color);">
                <h2 id="modal-title" class="text-xl sm:text-2xl font-semibold" style="color: var(--accent-color);"></h2>
                <button id="close-modal-btn" class="text-gray-400 hover:text-red-500 transition-colors">
                    <i data-lucide="x-circle" class="w-8 h-8"></i>
                </button>
            </div>
            <div id="modal-body" class="p-4 sm:p-6 space-y-5"></div>
        </div>
    </div>
    
    <div class="container mx-auto p-4 sm:px-6 md:px-8 mt-16">
        <section class="bg-gray-900 border-2 border-gray-700 rounded-lg p-6 flex flex-col sm:flex-row items-center justify-between gap-6 fade-in-up" style="animation-delay: 50ms;">
            <div class="flex-1">
                <h2 class="text-xl sm:text-2xl font-bold text-white mb-3">ผู้รับผิดชอบโครงการ</h2>
                <p class="text-lg font-semibold text-white">Frank Chetsarit</p>
                <p class="text-md text-gray-400">Graphic design NTK</p>
                <div class="mt-4 space-y-2 text-gray-300">
                    <p class="flex items-center space-x-2"><i data-lucide="phone" class="w-4 h-4" style="color: var(--accent-color);"></i><span>081-262-5455</span></p>
                    <p class="flex items-center space-x-2"><i data-lucide="message-square" class="w-4 h-4" style="color: var(--accent-color);"></i><span>Line ID: frankchetsarit</span></p>
                </div>
            </div>
            <div class="text-center">
                 <canvas id="qr-code" class="rounded-lg border-2" style="border-color: var(--accent-color);"></canvas>
                 <p class="mt-2 text-sm font-semibold" style="color: var(--accent-color);">สแกนเพื่อแชร์หน้านี้</p>
            </div>
        </section>
    </div>

    <footer class="mt-10 py-10 border-t border-gray-800">
        <div class="container mx-auto text-center text-gray-500 px-4">
            <p id="footer-restaurant-name" class="font-bold text-base sm:text-lg text-gray-400"></p>
            <p class="text-sm mt-1">Production & Content Calendar Management System</p>
            <p class="text-xs mt-2">&copy; 2025 All Rights Reserved.</p>
        </div>
    </footer>


    <script>
        const allRestaurantsData = {
            "ร้านลูกเจี๊ยบ หมูกระทะ": {
                theme: "default",
                weeks: [ { weekNumber: 1, range: "1–7 ตุลาคม 2025", shootDate: "3 ตุลาคม 2025", theme: "อบอุ่น, ตลก, โปรโมต, โรแมนติก", content: Array(7).fill({}).map((_, i) => ({ postDate: `${i + 1} ต.ค.`, title: `คอนเทนต์เปิดสัปดาห์ที่ 1 - วันที่ ${i+1}`, length: "0:30", details: "ข้อมูลตัวอย่าง", mood: "รอรายละเอียด", filming: "รอรายละเอียด", equipment: "มือถือ, ไฟ LED", location: "ในร้าน", shootDate: "3 ต.ค.", notes: "โทนรวม: อบอุ่น, ตลก, โปรโมต, โรแมนติก" })) }, { weekNumber: 2, range: "8–14 ตุลาคม 2025", shootDate: "10 ตุลาคม 2025", theme: "ไวรัล, ครอบครัว, โปรโมชัน", content: [ { postDate: "8 ต.ค.", title: "🍖 หมูเต้นบนเตา (ไวรัล)", length: "0:15", shootDate: "10 ต.ค." }, { postDate: "9 ต.ค.", title: "👨‍👩‍👧 คืนแห่งครอบครัว", length: "0:45", shootDate: "10 ต.ค." }, { postDate: "10 ต.ค.", title: "🧂 เบื้องหลัง “เตรียมหมู”", length: "0:60", shootDate: "10 ต.ค." }, { postDate: "11 ต.ค.", title: "💬 เสียงพากย์พนักงาน", length: "0:30", shootDate: "10 ต.ค." }, { postDate: "12 ต.ค.", title: "🐷 โปร “มากับเพื่อนลดอีก!”", length: "0:20", shootDate: "10 ต.ค." }, { postDate: "13 ต.ค.", title: "🔥 สโลว์หมูไหม้ (Art shot)", length: "0:10", shootDate: "10 ต.ค." }, { postDate: "14 ต.ค.", title: "🪩 รวมช็อตบรรยากาศ", length: "0:60", shootDate: "10 ต.ค." } ] }, { weekNumber: 3, range: "15–21 ตุลาคม 2025", shootDate: "17 ตุลาคม 2025", theme: "เทศกาลกินเจ, คุ้มค่า", content: [ { postDate: "15 ต.ค.", title: "🧘‍♀️ หมูกระทะเจก็มีนะ", length: "0:45", shootDate: "17 ต.ค." }, { postDate: "16 ต.ค.", title: "😂 มีม “สายเนื้อแอบกินเจ”", length: "0:15", shootDate: "17 ต.ค." }, { postDate: "17 ต.ค.", title: "💬 รีวิวจริง “มากี่ครั้งก็ไม่เบื่อ”", length: "0:30", shootDate: "17 ต.ค." }, { postDate: "18 ต.ค.", title: "🐷 โปร “เติมหมูฟรี 1 ถาด!”", length: "0:20", shootDate: "17 ต.ค." }, { postDate: "19 ต.ค.", title: "🔥 สโลว์ควันเตา “อุ่นหัวใจ”", length: "0:10", shootDate: "17 ต.ค." }, { postDate: "20 ต.ค.", title: "🎥 เบื้องหลัง “วันถ่ายจริงทีมงาน”", length: "0:60", shootDate: "17 ต.ค." }, { postDate: "21 ต.ค.", title: "🧊 น้ำแข็งเย็นใจ", length: "0:15", shootDate: "17 ต.ค." } ] }, { weekNumber: 4, range: "22–28 ตุลาคม 2025", shootDate: "24 ตุลาคม 2025", theme: "ปลายเดือน, โปรแรง", content: [ { postDate: "22 ต.ค.", title: "🍲 “เปิดหม้อ” ASMR", length: "0:20", shootDate: "24 ต.ค." }, { postDate: "23 ต.ค.", title: "😂 มีม “เพื่อนชวนกินหมูกระทะ”", length: "0:25", shootDate: "24 ต.ค." }, { postDate: "24 ต.ค.", title: "💸 โปรปลายเดือน “3 จ่าย 2”", length: "0:40", shootDate: "24 ต.ค." }, { postDate: "25 ต.ค.", title: "🐣 ขอบคุณลูกค้า", length: "0:45", shootDate: "24 ต.ค." }, { postDate: "26 ต.ค.", title: "🎞️ รวมโมเมนต์เด่น", length: "0:60", shootDate: "24 ต.ค." }, { postDate: "27 ต.ค.", title: "💬 รีวิวสายครอบครัว", length: "0:35", shootDate: "24 ต.ค." }, { postDate: "28 ต.ค.", title: "🔥 ช็อตไฟเตาลุก", length: "0:10", shootDate: "24 ต.ค." } ] }, { weekNumber: 5, range: "29–31 ตุลาคม 2025", shootDate: "ใช้ฟุตเทจจากวันที่ 24 ต.ค.", theme: "สรุปและขอบคุณ", content: [ { postDate: "29 ต.ค.", title: "😋 “หมูสุกกำลังดี” (ASMR)", length: "0:10", shootDate: "24 ต.ค." }, { postDate: "30 ต.ค.", title: "🎉 “โปรเดือนหน้า”", length: "0:20", shootDate: "24 ต.ค." }, { postDate: "31 ต.ค.", title: "🎈 ลูกค้าประจำพูดถึงร้าน", length: "0:45", shootDate: "24 ต.ค." } ] } ],
                backup: [ { title: "🌧️ วันฝนตก" }, { title: "🪑 ร้านว่างๆ" }, { title: "🐷 ถามเมนูโปรด" }, { title: "😋 หมูสุก ASMR" }, { title: "🎉 โปรใหม่" }, { title: "🎈 รีวิวลูกค้าประจำ" } ]
            },
            "ร้านอิ่มสุข หมูกระทะ": {
                theme: "blue",
                weeks: [ { weekNumber: 1, range: "1–7 ต.ค. 2025", shootDate: "1 ตุลาคม 2025", content: [ { postDate: "1 ต.ค.", title: "เปิดเดือนอิ่มสุข", shootDate: "1 ต.ค." }, { postDate: "2 ต.ค.", title: "หมูกระทะรวมมิตร", shootDate: "1 ต.ค." }, { postDate: "3 ต.ค.", title: "ทีมงานเบื้องหลัง", shootDate: "1 ต.ค." }, { postDate: "4 ต.ค.", title: "ลูกค้าประจำพูดถึงร้าน", shootDate: "1 ต.ค." }, { postDate: "5 ต.ค.", title: "ควันลอย slow motion", shootDate: "1 ต.ค." }, { postDate: "6 ต.ค.", title: "เสียงกระทะ x เพลงชิล", shootDate: "1 ต.ค." }, { postDate: "7 ต.ค.", title: "รวมช็อตกินแซ่บ", shootDate: "1 ต.ค." } ] }, { weekNumber: 2, range: "8–13 ต.ค. 2025", shootDate: "8 ตุลาคม 2025", content: [ { postDate: "8 ต.ค.", title: "เบื้องหลังวันฝนตก", shootDate: "8 ต.ค." }, { postDate: "9 ต.ค.", title: "หมูย่างตอนกลางคืน", shootDate: "8 ต.ค." }, { postDate: "10 ต.ค.", title: "โปรวันศุกร์สุขใจ", shootDate: "8 ต.ค." }, { postDate: "11 ต.ค.", title: "หมูกระทะรวมเพื่อน", shootDate: "8 ต.ค." }, { postDate: "12 ต.ค.", title: "รวมเสียงหัวเราะ", shootDate: "8 ต.ค." }, { postDate: "13 ต.ค.", title: "มุมเด็ดของร้าน", shootDate: "8 ต.ค." } ] }, { weekNumber: 3, range: "14–19 ต.ค. 2025", shootDate: "15 ตุลาคม 2025", content: [ { postDate: "14 ต.ค.", title: "เตรียมของก่อนเปิดร้าน", shootDate: "15 ต.ค." }, { postDate: "15 ต.ค.", title: "ชุดหมูรวมยอดฮิต", shootDate: "15 ต.ค." }, { postDate: "16 ต.ค.", title: "ลูกค้าเด็กๆ", shootDate: "15 ต.ค." }, { postDate: "17 ต.ค.", title: "เสียงเตา ASMR", shootDate: "15 ต.ค." }, { postDate: "18 ต.ค.", title: "ลูกค้า tag ร้าน", shootDate: "15 ต.ค." }, { postDate: "19 ต.ค.", title: "วันครอบครัวอิ่มสุข", shootDate: "15 ต.ค." } ] }, { weekNumber: 4, range: "20–25 ต.ค. 2025", shootDate: "22 ตุลาคม 2025", content: [ { postDate: "20 ต.ค.", title: "ชุดผักสด", shootDate: "22 ต.ค." }, { postDate: "21 ต.ค.", title: "เตรียมเตา", shootDate: "22 ต.ค." }, { postDate: "22 ต.ค.", title: "โปรกลางเดือน", shootDate: "22 ต.ค." }, { postDate: "23 ต.ค.", title: "รวมช็อตเด็ดหมู", shootDate: "22 ต.ค." }, { postDate: "24 ต.ค.", title: "เสียงหัวเราะลูกค้า", shootDate: "22 ต.ค." }, { postDate: "25 ต.ค.", title: "หมูกระทะยามค่ำคืน", shootDate: "22 ต.ค." } ] }, { weekNumber: 5, range: "26–31 ต.ค. 2025", shootDate: "29 ตุลาคม 2025", content: [ { postDate: "26 ต.ค.", title: "พนักงานสายฮา", shootDate: "29 ต.ค." }, { postDate: "27 ต.ค.", title: "เตรียมวัตถุดิบใหม่", shootDate: "29 ต.ค." }, { postDate: "28 ต.ค.", title: "รวมรอยยิ้มเดือนนี้", shootDate: "29 ต.ค." }, { postDate: "29 ต.ค.", title: "เจ้าของร้านฝากถึงลูกค้า", shootDate: "29 ต.ค." }, { postDate: "30 ต.ค.", title: "รีวิวเด่นประจำเดือน", shootDate: "29 ต.ค." }, { postDate: "31 ต.ค.", title: "อิ่มสุขส่งท้ายเดือน", shootDate: "29 ต.ค." } ] } ],
                backup: [ { title: "🌧️ ฝนตกก็อิ่มสุข" }, { title: "🎬 เบื้องหลังทีมงาน" }, { title: "🥩 หมูสดวันนี้" }, { title: "🎤 รีวิวสั้น" }, { title: "🔥 ช็อตไฟ slow" }, { title: "💬 ข้อคิดจากเจ้าของ" } ]
            },
            "ร้านนฏกรเทเลคอม": {
                theme: "green",
                weeks: [
                    {
                        weekNumber: 1, range: "1–7 ต.ค. 2025", shootDate: "6 ตุลาคม 2025", theme: "เปิดตัว, รีวิว, ให้ความรู้",
                        content: [
                            { postDate: "1 ต.ค.", title: "เปิดเดือนกับนฏกร", length: "0:40", shootDate: "6 ต.ค." },
                            { postDate: "2 ต.ค.", title: "รีวิวมือถือรุ่นฮิต", length: "0:45", shootDate: "6 ต.ค." },
                            { postDate: "3 ต.ค.", title: "Tips: วิธีเช็กเครื่องแท้", length: "0:35", shootDate: "6 ต.ค." },
                            { postDate: "4 ต.ค.", title: "โปรสายช้อป", length: "0:30", shootDate: "6 ต.ค." },
                            { postDate: "5 ต.ค.", title: "บรรยากาศวันอาทิตย์", length: "0:50", shootDate: "6 ต.ค." },
                            { postDate: "6 ต.ค.", title: "เบื้องหลังทีมขาย", length: "0:45", shootDate: "6 ต.ค." },
                            { postDate: "7 ต.ค.", title: "เปรียบเทียบรุ่นคู่แข่ง", length: "0:50", shootDate: "6 ต.ค." }
                        ]
                    },
                    {
                        weekNumber: 2, range: "8–13 ต.ค. 2025", shootDate: "13 ตุลาคม 2025", theme: "รีวิว, How-to, บรรยากาศ",
                        content: [
                            { postDate: "8 ต.ค.", title: "ลูกค้าแรกของวัน", length: "0:30", shootDate: "13 ต.ค." },
                            { postDate: "9 ต.ค.", title: "Accessories Highlight", length: "0:35", shootDate: "13 ต.ค." },
                            { postDate: "10 ต.ค.", title: "รีวิวจากลูกค้าจริง", length: "0:45", shootDate: "13 ต.ค." },
                            { postDate: "11 ต.ค.", title: "เทคนิคถ่ายรูปมือถือ", length: "0:50", shootDate: "13 ต.ค." },
                            { postDate: "12 ต.ค.", title: "พนักงานสายฮา", length: "0:40", shootDate: "13 ต.ค." },
                            { postDate: "13 ต.ค.", title: "โปรวันจันทร์", length: "0:30", shootDate: "13 ต.ค." }
                        ]
                    },
                    {
                        weekNumber: 3, range: "14–20 ต.ค. 2025", shootDate: "20 ตุลาคม 2025", theme: "ศูนย์ซ่อม, How-to, รีวิวสินค้า",
                        content: [
                           { postDate: "14 ต.ค.", title: "Behind Scene ซ่อมมือถือ", length: "0:45", shootDate: "20 ต.ค." },
                           { postDate: "15 ต.ค.", title: "สอนเช็กแบตเสื่อม", length: "0:35", shootDate: "20 ต.ค." },
                           { postDate: "16 ต.ค.", title: "รีวิวเคสกันกระแทก", length: "0:40", shootDate: "20 ต.ค." },
                           { postDate: "17 ต.ค.", title: "ลูกค้าซ่อมเสร็จ", length: "0:30", shootDate: "20 ต.ค." },
                           { postDate: "18 ต.ค.", title: "รีวิวหูฟังบลูทูธ", length: "0:50", shootDate: "20 ต.ค." },
                           { postDate: "19 ต.ค.", title: "พนักงานแนะนำรุ่นขายดี", length: "0:45", shootDate: "20 ต.ค." },
                           { postDate: "20 ต.ค.", title: "รวมสินค้าทั้งร้าน", length: "0:60", shootDate: "20 ต.ค." }
                        ]
                    },
                    {
                        weekNumber: 4, range: "21–27 ต.ค. 2025", shootDate: "27 ตุลาคม 2025", theme: "How-to, บรรยากาศ, เบื้องหลัง",
                        content: [
                            { postDate: "21 ต.ค.", title: "รวมสินค้าทั้งร้าน", length: "0:60", shootDate: "20 ต.ค." },
                            { postDate: "22 ต.ค.", title: "ลูกค้าเปรียบเทียบราคา", length: "0:35", shootDate: "27 ต.ค." },
                            { postDate: "23 ต.ค.", title: "เคล็ดลับยืดอายุแบต", length: "0:40", shootDate: "27 ต.ค." },
                            { postDate: "24 ต.ค.", title: "ทีมงานจัดของเช้า", length: "0:35", shootDate: "27 ต.ค." },
                            { postDate: "25 ต.ค.", title: "บรรยากาศห้างวันเสาร์", length: "0:45", shootDate: "27 ต.ค." },
                            { postDate: "26 ต.ค.", title: "Tips: มือถือช้าแก้ยังไง", length: "0:50", shootDate: "27 ต.ค." }
                        ]
                    },
                    {
                        weekNumber: 5, range: "28–31 ต.ค. 2025", shootDate: "27 ตุลาคม 2025", theme: "ปิดท้ายเดือน, ขอบคุณลูกค้า",
                        content: [
                           { postDate: "27 ต.ค.", title: "วันถ่ายจริงสุดท้าย", length: "-", shootDate: "27 ต.ค." },
                           { postDate: "28 ต.ค.", title: "รวมช็อตประจำเดือน", length: "0:60", shootDate: "27 ต.ค." },
                           { postDate: "29 ต.ค.", title: "ทีมงานขอบคุณลูกค้า", length: "0:45", shootDate: "27 ต.ค." },
                           { postDate: "30 ต.ค.", title: "รีวิวเด่นประจำเดือน", length: "0:30", shootDate: "27 ต.ค." },
                           { postDate: "31 ต.ค.", title: "พบกันเดือนหน้า", length: "0:40", shootDate: "27 ต.ค." }
                        ]
                    }
                ],
                backup: [
                    { title: "มือถือตกน้ำ ทำยังไงดี", notes: "how-to" },
                    { title: "ลูกค้าพูดตรงๆ หลังใช้ 1 เดือน", notes: "รีวิวจริง" },
                    { title: "เปลี่ยนฟิล์มใน 2 นาที", notes: "speed edit" },
                    { title: "ศูนย์ซ่อมเบื้องหลัง", notes: "B-roll เทคนิค" },
                    { title: "รวมช็อต Fail ในร้าน", notes: "ขำขัน" },
                    { title: "Q&A จาก TikTok", notes: "รวมคำถามยอดฮิต" }
                ]
            }
        };

        const modal = document.getElementById('detail-modal');
        const modalContent = document.getElementById('modal-content');
        const modalTitle = document.getElementById('modal-title');
        const modalBody = document.getElementById('modal-body');
        const closeModalBtn = document.getElementById('close-modal-btn');
        const restaurantTabsContainer = document.getElementById('restaurant-tabs');
        const restaurantNameHeader = document.getElementById('restaurant-name-header');
        const footerRestaurantName = document.getElementById('footer-restaurant-name');

        const thaiMonthMap = { 'มกราคม': 'ม.ค.', 'กุมภาพันธ์': 'ก.พ.', 'มีนาคม': 'มี.ค.', 'เมษายน': 'เม.ย.', 'พฤษภาคม': 'พ.ค.', 'มิถุนายน': 'มิ.ย.', 'กรกฎาคม': 'ก.ค.', 'สิงหาคม': 'ส.ค.', 'กันยายน': 'ก.ย.', 'ตุลาคม': 'ต.ค.', 'พฤศจิกายน': 'พ.ย.', 'ธันวาคม': 'ธ.ค.' };

        function normalizeDateKey(dateStr) {
            if (!dateStr) return '';
            const parts = dateStr.split(' ');
            if (parts.length < 2) return dateStr;
            const day = parts[0];
            let month = parts[1];
            if (thaiMonthMap[month]) {
                month = thaiMonthMap[month];
            }
            return `${day} ${month}`;
        }
        
        function createDetailItem(icon, label, value) {
            return `<div class="flex items-start space-x-4"><div class="flex-shrink-0" style="color:var(--accent-color);"><i data-lucide="${icon}" class="w-5 h-5"></i></div><div><p class="font-semibold text-gray-400">${label}</p><p class="text-gray-200 text-base sm:text-lg">${value || 'N/A'}</p></div></div>`;
        }
        
        function showModal(item) {
            modalTitle.textContent = item.title;
            modalBody.innerHTML = `
                ${createDetailItem('calendar', 'วันโพสต์', item.postDate)}
                ${createDetailItem('clock', 'ความยาว', item.length)}
                ${createDetailItem('film', 'รายละเอียดช็อตต่อช็อต', item.details?.replace(/\//g, '<br/>'))}
                ${createDetailItem('music', 'Mood / เพลง', item.mood)}
                ${createDetailItem('camera', 'วิธีถ่ายทำ / มุมกล้อง', item.filming)}
                ${createDetailItem('box', 'วัสดุ / อุปกรณ์', item.equipment)}
                ${createDetailItem('map-pin', 'สถานที่ถ่าย', item.location)}
                ${createDetailItem('star', 'วันที่ถ่ายจริง', item.shootDate)}
                ${createDetailItem('file-text', 'หมายเหตุ', item.notes)}
            `;
            lucide.createIcons();
            modal.classList.remove('opacity-0', 'invisible');
            modalContent.classList.remove('scale-95');
        }

        function hideModal() {
            modal.classList.add('opacity-0');
            modalContent.classList.add('scale-95');
            setTimeout(() => { modal.classList.add('invisible'); }, 300);
        }
        
        function renderPageForRestaurant(restaurantName) {
            const restaurantData = allRestaurantsData[restaurantName];
            document.body.dataset.theme = restaurantData.theme || 'default';

            const scheduleContainer = document.getElementById('schedule-container');
            const calendarContainer = document.getElementById('calendar-container');

            scheduleContainer.innerHTML = '';
            calendarContainer.innerHTML = '';
            restaurantNameHeader.textContent = `${restaurantName} | ตุลาคม 2025`;
            footerRestaurantName.textContent = `${restaurantName} Official`;

            const shootingSchedule = {};
            const contentByDate = new Map();

            restaurantData.weeks.forEach((week, weekIndex) => {
                const rawShootDateKey = week.shootDate; 
                if (!rawShootDateKey.startsWith("ใช้ฟุตเทจ")) {
                    const shootDateKey = normalizeDateKey(rawShootDateKey);
                    if (!shootingSchedule[shootDateKey]) {
                        shootingSchedule[shootDateKey] = [];
                    }
                }
                
                week.content.forEach((item, contentIndex) => {
                    const postDateKey = normalizeDateKey(item.postDate);
                    if (!contentByDate.has(postDateKey)) {
                        contentByDate.set(postDateKey, []);
                    }
                    contentByDate.get(postDateKey).push({ ...item, weekIndex, contentIndex });
                    
                    const shootDateKey = normalizeDateKey(item.shootDate);
                    if (shootingSchedule[shootDateKey]) {
                         const scheduleItem = { title: item.title, weekIndex: weekIndex, contentIndex: contentIndex };
                        if (!shootingSchedule[shootDateKey].some(existingItem => existingItem.title === scheduleItem.title)) {
                            shootingSchedule[shootDateKey].push(scheduleItem);
                        }
                    }
                });
            });

            for (const date in shootingSchedule) {
                const scheduleItemEl = document.createElement('div');
                scheduleItemEl.className = 'bg-gray-900 border-2 border-gray-700 rounded-lg overflow-hidden transition-all duration-300 hover:border-current';
                const items = shootingSchedule[date];
                scheduleItemEl.innerHTML = `<button class="w-full flex justify-between items-center p-4 text-left hover:bg-gray-800 transition-colors duration-300"><span class="text-lg sm:text-xl font-semibold text-white">${date}</span><div class="flex items-center space-x-3"><span class="font-bold" style="color:var(--accent-color);">${items.length} รายการ</span><i data-lucide="chevron-down" class="transition-transform duration-300" style="color:var(--accent-color);"></i></div></button><div class="h-0 overflow-hidden transition-all duration-500 ease-in-out"><ul class="p-4 pt-0 border-t-2 border-gray-800 list-inside text-gray-300 space-y-2 text-sm sm:text-base">${items.map(item => `<li class="cursor-pointer hover:text-[var(--accent-color)] transition-colors duration-200 pl-2" data-week="${item.weekIndex}" data-content="${item.contentIndex}">${item.title}</li>`).join('')}</ul></div>`;
                scheduleContainer.appendChild(scheduleItemEl);
            }

            const calendarGrid = document.createElement('div');
            calendarGrid.className = 'calendar-grid';
            ['อา.', 'จ.', 'อ.', 'พ.', 'พฤ.', 'ศ.', 'ส.'].forEach(day => {
                calendarGrid.innerHTML += `<div class="calendar-header">${day}</div>`;
            });

            const firstDayOfMonth = new Date(2025, 9, 1).getDay();
            const daysInMonth = 31;

            for (let i = 0; i < firstDayOfMonth; i++) {
                calendarGrid.innerHTML += `<div class="calendar-day other-month"></div>`;
            }

            for (let day = 1; day <= daysInMonth; day++) {
                const dateKey = `${day} ต.ค.`;
                const dayEl = document.createElement('div');
                dayEl.className = 'calendar-day';
                
                const dayNumberDiv = document.createElement('div');
                dayNumberDiv.className = 'day-number flex justify-between items-center';
                dayNumberDiv.innerHTML = `<span>${day}</span>`;

                const shootDateKeyForThisDay = Object.keys(shootingSchedule).find(shootKey => parseInt(shootKey.split(' ')[0]) === day);
                
                if (shootDateKeyForThisDay) {
                    const shootBadgeContainer = document.createElement('div');
                    shootBadgeContainer.className = 'shoot-day-badge-container';
                    const popoverList = shootingSchedule[shootDateKeyForThisDay].map(sItem => `<li data-week="${sItem.weekIndex}" data-content="${sItem.contentIndex}">${sItem.title}</li>`).join('');
                    shootBadgeContainer.innerHTML = `<span class="shoot-day-badge text-xs px-2 py-0.5 rounded">SHOOT</span><div class="shoot-day-popover"><h4 class="font-bold mb-1 text-sm" style="color:var(--accent-color);">รายการที่ถ่ายวันนี้:</h4><ul>${popoverList}</ul></div>`;
                    dayNumberDiv.appendChild(shootBadgeContainer);
                }

                dayEl.appendChild(dayNumberDiv);
                
                const dayContent = document.createElement('div');
                dayContent.className = 'space-y-1';

                if (contentByDate.has(dateKey)) {
                    contentByDate.get(dateKey).forEach(item => {
                        const contentEl = document.createElement('div');
                        contentEl.className = 'content-entry';
                        contentEl.textContent = item.title;
                        contentEl.dataset.week = item.weekIndex;
                        contentEl.dataset.content = item.contentIndex;
                        dayContent.appendChild(contentEl);
                    });
                }
                dayEl.appendChild(dayContent);
                calendarGrid.appendChild(dayEl);
            }
            calendarContainer.appendChild(calendarGrid);

            // Re-bind all event listeners
            document.querySelectorAll('.content-entry').forEach(entry => {
                 entry.addEventListener('click', (e) => {
                    const weekIndex = e.currentTarget.dataset.week;
                    const contentIndex = e.currentTarget.dataset.content;
                    const item = restaurantData.weeks[weekIndex].content[contentIndex];
                    showModal(item);
                });
            });

            scheduleContainer.querySelectorAll('button').forEach(button => {
                button.addEventListener('click', () => {
                    const contentDiv = button.nextElementSibling;
                    const icon = button.querySelector('i[data-lucide="chevron-down"]');
                    scheduleContainer.querySelectorAll('.h-auto').forEach(openContent => {
                        if (openContent !== contentDiv) {
                            openContent.style.height = '0px';
                            openContent.previousElementSibling.querySelector('i[data-lucide="chevron-down"]').style.transform = 'rotate(0deg)';
                        }
                    });
                    if (contentDiv.style.height && contentDiv.style.height !== '0px') {
                        contentDiv.style.height = '0px';
                        if(icon) icon.style.transform = 'rotate(0deg)';
                    } else {
                        contentDiv.style.height = `${contentDiv.scrollHeight}px`;
                        if(icon) icon.style.transform = 'rotate(180deg)';
                    }
                });
            });

            document.querySelectorAll('#schedule-container li, .shoot-day-popover li').forEach(li => {
                li.addEventListener('click', (e) => {
                    e.stopPropagation(); 
                    const weekIndex = li.dataset.week;
                    const contentIndex = li.dataset.content;
                    if (weekIndex !== undefined && contentIndex !== undefined) {
                        const item = restaurantData.weeks[weekIndex].content[contentIndex];
                        showModal(item);
                    }
                });
            });

            document.querySelectorAll('.shoot-day-badge-container').forEach(container => {
                container.querySelector('.shoot-day-badge').addEventListener('click', (event) => {
                    event.stopPropagation();
                    const popover = container.querySelector('.shoot-day-popover');
                    document.querySelectorAll('.shoot-day-popover.popover-visible').forEach(p => {
                        if (p !== popover) p.classList.remove('popover-visible');
                    });
                    popover.classList.toggle('popover-visible');
                });
            });
            
            lucide.createIcons();
        }

        function setupTabs() {
            const restaurantNames = Object.keys(allRestaurantsData);
            restaurantTabsContainer.innerHTML = '';
            restaurantNames.forEach((name, index) => {
                const tab = document.createElement('button');
                tab.className = 'restaurant-tab text-gray-400 font-semibold py-3 px-6 hover:text-[var(--accent-color)] whitespace-nowrap';
                tab.textContent = name;
                tab.dataset.restaurant = name;
                if (index === 0) {
                    tab.classList.add('active');
                }
                restaurantTabsContainer.appendChild(tab);
            });

            restaurantTabsContainer.addEventListener('click', (e) => {
                if (e.target.matches('.restaurant-tab')) {
                    const restaurantName = e.target.dataset.restaurant;
                    if (restaurantTabsContainer.querySelector('.active')) {
                        restaurantTabsContainer.querySelector('.active').classList.remove('active');
                    }
                    e.target.classList.add('active');
                    renderPageForRestaurant(restaurantName);
                }
            });
        }
        
        closeModalBtn.addEventListener('click', hideModal);
        
        document.addEventListener('click', (e) => {
            if (e.target === modal) hideModal();
            if (!e.target.closest('.shoot-day-badge-container')) {
                document.querySelectorAll('.shoot-day-popover.popover-visible').forEach(p => p.classList.remove('popover-visible'));
            }
        });

        window.onload = function() {
            new QRious({ element: document.getElementById('qr-code'), value: window.location.href, size: 140, padding: 10, background: '#ffffff', foreground: '#000000' });
            setupTabs();
            renderPageForRestaurant(Object.keys(allRestaurantsData)[0]);
        };
    </script>
</body>
</html>

